<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global AI Patent Landscape by Era</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>

    <style>
        body {
            font-family: sans-serif;
            line-height: 1.6;
            margin: 20px;
            padding: 0;
        }
        h1, h2 {
            text-align: center;
            color: #333;
        }
        #map {
            height: 500px; /* Adjust height as needed */
            width: 90%;  /* Adjust width as needed */
            margin: 10px auto; /* Center the map */
            border: 1px solid #ccc;
        }
        .map-controls {
            text-align: center;
            margin: 15px 0;
        }
        .map-controls button {
            padding: 8px 15px;
            margin: 0 5px;
            font-size: 1em;
            cursor: pointer;
            border: 1px solid #ccc;
            background-color: #f0f0f0;
            border-radius: 4px;
        }
        .map-controls button.active {
            background-color: #ddd;
            font-weight: bold;
            border-color: #aaa;
        }
        .description {
            max-width: 800px;
            margin: 20px auto;
            padding: 15px;
            background-color: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 5px;
        }
        p {
            color: #555;
        }
        .legend {
            padding: 6px 8px;
            font: 14px Arial, Helvetica, sans-serif;
            background: white;
            background: rgba(255,255,255,0.8);
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border-radius: 5px;
            line-height: 18px;
             color: #555;
        }
        .legend i {
            width: 18px;
            height: 18px;
            float: left;
            margin-right: 8px;
            opacity: 0.7;
        }
    </style>
</head>
<body>

    <h1>Global AI Patent Landscape by Era (Illustrative)</h1>

    <div id="map"></div>

    <div class="map-controls">
        <button id="btn-1990" data-period="1990-2000">1990 - 2000</button>
        <button id="btn-2001" data-period="2001-2010">2001 - 2010</button>
        <button id="btn-2011" data-period="2011-Present" class="active">2011 - Present</button>
         </div>

    <div class="description">
        <h2>About AI Patents and This Map</h2>
        <p>
            Artificial Intelligence (AI) patents represent inventions utilizing AI techniques. Tracking these patents reveals innovation trends and geographic R&D concentration.
        </p>
        <p>
            <strong>About this map:</strong> This interactive map visualizes the estimated number of AI-related patent filings/grants for different time periods. The size of the circle is proportional to the patent count, and the color indicates the relative volume (Red = High, Orange = Medium, Yellow = Low). Use the buttons above to select a time period. Click on a circle for details.
        </p>
         <p>
            <em><strong>Disclaimer:</strong> The data presented here is purely illustrative and randomly generated for demonstration purposes. It does not reflect actual, up-to-date AI patent statistics.</em>
        </p>
    </div>

    <script>
        // --- Map Initialization ---
        var map = L.map('map').setView([20, 10], 2);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // --- Placeholder Data by Time Period ---
        // Structure: { 'period_key': [ { lat, lon, patents, region }, ... ] }
        const patentDataByPeriod = {
            '1990-2000': [
                { lat: 38.9, lon: -77.0, patents: 5000, region: "USA (East Coast)" },
                { lat: 37.7, lon: -122.4, patents: 7000, region: "USA (West Coast)" },
                { lat: 35.6, lon: 139.6, patents: 6000, region: "Japan" },
                { lat: 39.9, lon: 116.4, patents: 500, region: "China" },
                { lat: 37.5, lon: 126.9, patents: 800, region: "South Korea" },
                { lat: 51.5, lon: -0.1, patents: 1500, region: "United Kingdom" },
                { lat: 48.8, lon: 2.3, patents: 1200, region: "France" },
                { lat: 52.5, lon: 13.4, patents: 1800, region: "Germany" },
                { lat: 43.6, lon: -79.3, patents: 900, region: "Canada" },
                { lat: 47.3, lon: 8.5, patents: 700, region: "Switzerland" }
            ],
            '2001-2010': [
                { lat: 38.9, lon: -77.0, patents: 18000, region: "USA (East Coast)" },
                { lat: 37.7, lon: -122.4, patents: 22000, region: "USA (West Coast)" },
                { lat: 35.6, lon: 139.6, patents: 15000, region: "Japan" },
                { lat: 39.9, lon: 116.4, patents: 12000, region: "China" },
                { lat: 37.5, lon: 126.9, patents: 10000, region: "South Korea" },
                { lat: 51.5, lon: -0.1, patents: 7000, region: "United Kingdom" },
                { lat: 48.8, lon: 2.3, patents: 6000, region: "France" },
                { lat: 52.5, lon: 13.4, patents: 8000, region: "Germany" },
                { lat: 43.6, lon: -79.3, patents: 5000, region: "Canada" },
                { lat: 22.3, lon: 114.1, patents: 4000, region: "Hong Kong / Shenzhen Area" },
                { lat: 19.0, lon: 72.8, patents: 2000, region: "India" },
                { lat: -33.8, lon: 151.2, patents: 1500, region: "Australia" },
                { lat: 47.3, lon: 8.5, patents: 3500, region: "Switzerland" }
            ],
            '2011-Present': [
                { lat: 38.9, lon: -77.0, patents: 55000, region: "USA (East Coast)" },
                { lat: 37.7, lon: -122.4, patents: 65000, region: "USA (West Coast)" },
                { lat: 35.6, lon: 139.6, patents: 35000, region: "Japan" },
                { lat: 39.9, lon: 116.4, patents: 95000, region: "China" }, // Increased China significantly
                { lat: 37.5, lon: 126.9, patents: 30000, region: "South Korea" },
                { lat: 51.5, lon: -0.1, patents: 25000, region: "United Kingdom" },
                { lat: 48.8, lon: 2.3, patents: 22000, region: "France" },
                { lat: 52.5, lon: 13.4, patents: 28000, region: "Germany" },
                { lat: 43.6, lon: -79.3, patents: 18000, region: "Canada" },
                { lat: 22.3, lon: 114.1, patents: 15000, region: "Hong Kong / Shenzhen Area" },
                { lat: 19.0, lon: 72.8, patents: 10000, region: "India" },
                { lat: -33.8, lon: 151.2, patents: 8000, region: "Australia" },
                { lat: 47.3, lon: 8.5, patents: 12000, region: "Switzerland" }
            ]
        };

        // --- Layer Group for Markers ---
        // We use a layer group to easily clear and add markers
        let markerGroup = L.layerGroup().addTo(map);

        // --- Color Scaling Function ---
        // Returns a color based on patent count. Adjust thresholds as needed.
        // Using simple thresholds: >40k = red, >10k = orange, else yellow
        function getColor(patentCount) {
            if (patentCount > 40000) {
                return '#FF0000'; // Red
            } else if (patentCount > 10000) {
                return '#FFA500'; // Orange
            } else {
                return '#FFFF00'; // Yellow
            }
            // You could implement a more sophisticated continuous scale here later
        }

        // --- Function to Display Patents for a Given Period ---
        function displayPatents(period) {
            // Clear existing markers from the group
            markerGroup.clearLayers();

            const data = patentDataByPeriod[period];
            if (!data) {
                console.error("No data found for period:", period);
                return;
            }

            // Find max patents in the current dataset for radius scaling (optional but good)
            // let maxPatents = Math.max(...data.map(item => item.patents), 0);

            data.forEach(function(item) {
                // Calculate radius (sqrt scale helps visualize large differences)
                // Adjust the multiplier (e.g., 150) to get desired circle sizes
                var radius = Math.sqrt(item.patents) * 150;

                // Determine color based on patent count
                var fillColor = getColor(item.patents);

                // Create circle marker
                var circle = L.circle([item.lat, item.lon], {
                    color: '#555',      // Stroke color (dark grey)
                    weight: 1,         // Stroke weight
                    fillColor: fillColor, // Get color from function
                    fillOpacity: 0.6,  // Fill opacity
                    radius: radius
                });

                // Add popup
                circle.bindPopup(`<b>${item.region}</b><br>Period: ${period}<br>Estimated AI Patents: ~${item.patents.toLocaleString()}`);

                // Add the circle to the layer group
                circle.addTo(markerGroup);
            });

            // Update active button style
            document.querySelectorAll('.map-controls button').forEach(button => {
                button.classList.remove('active');
                if (button.dataset.period === period) {
                    button.classList.add('active');
                }
            });
        }

         // --- Legend ---
        var legend = L.control({position: 'bottomright'});

        legend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 10001, 40001], // Thresholds used in getColor + lower bound
                labels = ['Low (<10k)', 'Medium (10k-40k)', 'High (>40k)']; // Corresponding labels

            div.innerHTML += '<strong>Patent Volume</strong><br>';
            // loop through our density intervals and generate a label with a colored square for each interval
            for (var i = 0; i < grades.length; i++) {
                // Get color for the start of the range (or slightly above for > checks)
                const gradeColorValue = grades[i] === 0 ? 1 : grades[i]; // Handle 0 case for getColor logic
                 div.innerHTML +=
                    '<i style="background:' + getColor(gradeColorValue) + '"></i> ' +
                    labels[i] + '<br>';
            }
            return div;
        };
        legend.addTo(map);


        // --- Event Listeners for Buttons ---
        document.getElementById('btn-1990').addEventListener('click', function() {
            displayPatents('1990-2000');
        });
        document.getElementById('btn-2001').addEventListener('click', function() {
            displayPatents('2001-2010');
        });
        document.getElementById('btn-2011').addEventListener('click', function() {
            displayPatents('2011-Present');
        });

        // --- Initial Map Load ---
        // Display the latest period by default when the page loads
        displayPatents('2011-Present');

    </script>

</body>
</html>
